return function(a)local b={}b.ssid=a.ssid;b.pwd=string.len(a.pwd)>=8 and a.pwd or nil;if a.mode and a.mode~=0 then print("mode: "..a.mode)wifi.setmode(a.mode)wifi.nullmodesleep(false)if a.mode==1 then wifi.sta.config(b)else wifi.ap.config(b)end;wifi.eventmon.register(wifi.eventmon.AP_STACONNECTED,function(c)if not srv_init then dofile('web.lua')end;local d=tmr.create()d:register(3000,tmr.ALARM_SINGLE,function(a)print(a.mode==1 and wifi.sta.getip()or wifi.ap.getip())a:unregister()end)d:start()end)else print("Wireless err")end end
